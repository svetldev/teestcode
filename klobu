import numpy as np

# Функция для вычисления ионосферной задержки по модели Клобучара
def klobuchar_iono_correction(el, A, B, C, D):
    """
    Рассчитывает ионосферную задержку по модели Клобучара.
    
    :param el: угол элевейшн (в градусах) для спутника
    :param A, B, C, D: параметры модели Клобучара (получены из навигационного сообщения)
    :return: ионосферная задержка в секундах
    """
    # Преобразуем угол элевейшн в радианы
    el_rad = np.radians(el)
    
    # Вычисляем задержку по модели Клобучара
    iono_delay = A * (1 + B * np.sin(el_rad)**2) + C * (1 + D * np.sin(el_rad)**2)
    
    return iono_delay

# Пример данных
el = 45.0  # угол элевейшн в градусах
A = 0.0001  # Параметр A из навигационного сообщения (амплитуда модели)
B = 0.0002  # Параметр B из навигационного сообщения (влияние на зависимость от угла элевейшн)
C = 0.0003  # Параметр C из навигационного сообщения (дополнительная корректировка)
D = 0.0004  # Параметр D из навигационного сообщения (влияние на зависимость от угла элевейшн)

# Рассчитываем ионосферную задержку
iono_delay = klobuchar_iono_correction(el, A, B, C, D)

print(f"Ионосферная задержка: {iono_delay:.6f} секунд")
